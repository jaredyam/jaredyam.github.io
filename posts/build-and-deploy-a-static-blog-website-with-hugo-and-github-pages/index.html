<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>使用 Hugo 和 GitHub Pages 搭建并部署一个静态博客网站 | 👨‍🌾 Jared Yam</title><meta name=keywords content="Hugo,GitHub Pages"><meta name=description content="🔎 https://<your-github-id>.github.io ↩️"><meta name=author content><link rel=canonical href=https://jaredyam.github.io/posts/build-and-deploy-a-static-blog-website-with-hugo-and-github-pages/><link crossorigin=anonymous href=/assets/css/stylesheet.min.905b36e802f274d20331df2b82cdbda026f31bdf17c6a11d01f1fd89a7fc2faa.css integrity="sha256-kFs26ALydNIDMd8rgs29oCbzG98XxqEdAfH9iaf8L6o=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.2840b7fccd34145847db71a290569594bdbdb00047097f75d6495d162f5d7dff.js integrity="sha256-KEC3/M00FFhH23GikFaVlL29sABHCX911kldFi9dff8=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://jaredyam.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://jaredyam.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://jaredyam.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://jaredyam.github.io/apple-touch-icon.png><link rel=mask-icon href=https://jaredyam.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="使用 Hugo 和 GitHub Pages 搭建并部署一个静态博客网站"><meta property="og:description" content="🔎 https://<your-github-id>.github.io ↩️"><meta property="og:type" content="article"><meta property="og:url" content="https://jaredyam.github.io/posts/build-and-deploy-a-static-blog-website-with-hugo-and-github-pages/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-03-06T20:29:59+08:00"><meta property="article:modified_time" content="2022-05-08T14:40:45+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="使用 Hugo 和 GitHub Pages 搭建并部署一个静态博客网站"><meta name=twitter:description content="🔎 https://<your-github-id>.github.io ↩️"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://jaredyam.github.io/posts/"},{"@type":"ListItem","position":3,"name":"使用 Hugo 和 GitHub Pages 搭建并部署一个静态博客网站","item":"https://jaredyam.github.io/posts/build-and-deploy-a-static-blog-website-with-hugo-and-github-pages/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"使用 Hugo 和 GitHub Pages 搭建并部署一个静态博客网站","name":"使用 Hugo 和 GitHub Pages 搭建并部署一个静态博客网站","description":"🔎 https://.github.io ↩️","keywords":["Hugo","GitHub Pages"],"articleBody":"最近打算将我在 CSDN 上发布并持续优化的部分内容同步至 GitHub，这些内容十分需要借助 Git 记录和追溯修改历史，而 GitHub 也可以作为这些内容的另一个获取平台。\n将文档直接丢进 GitHub 仓库好像又差点意思。GitHub Pages 为每个 GitHub 账户免费提供一项静态网站托管服务，通过域名 https://.github.io 即可访问同名仓库托管的静态网站。借助这项服务，我们可以依托 GitHub 仓库搭建一个静态博客网站，将文档以博客形式开放展阅。\n本文将介绍如何使用 Hugo 搭建静态博客网站、使用和定制 hugo-PaperMod 主题以及将网站部署在 GitHub Pages。\n 搭建静态网站 如今搭建静态网站的方法已经非常成熟，我根据网友讨论和个人喜好选择 Hugo 作为静态网站搭建框架，同样流行的框架还包括 Hexo、Jekyll 等。\n安装 Hugo 框架 Hugo 提供多种操作系统的安装指引。以我的 macOS 系统为例，可以通过包管理器 brew 快速完成安装：\nbrew install hugo 创建网站模板 使用 Hugo 可以快速创建一个网站模板：\nbrew new site .github.io -f yml 其中 .github.io 对应新建网站的项目文件夹（ 需替换为 GitHub ID），选项 -f 将网站配置文件设置为 YAML 格式，其目的是为与下文主题配置保持一致。为方便起见，下文将网站项目文件夹简称为「网站」。\n配置基础主题 在流行框架的基础上搭建网站其实并不是一个技术活，千差万别的网站体验则主要体现在网站主题的设计上。Hugo 提供丰富多样的主题模板，我根据网友讨论选择 adityatelange/hugo-PaperMod 作为基础主题。PaperMod 页面简洁，支持暗黑模式及众多实用特性。\n在网站根目录执行以下命令下载主题并初始化为 Git 子模块：\ngit clone https://github.com/adityatelange/hugo-PaperMod themes/PaperMod --depth=1 git init git submodule--helper add https://github.com/adityatelange/hugo-PaperMod.git themes/PaperMod --depth=1 随后，我们只需将主题名称写入配置文件 ./config.yml：\nbaseURL:https://jaredyam.github.iolanguageCode:en-usdefaultContentLanguage:zhtitle:👨‍🌾 Jared Yam# 主题theme:PaperMod便搭建完成了一个完整的静态博客网站。\n执行以下命令可以在本地预览网站：\nhugo server -D 其中选项 -D 允许在预览网站时渲染未发布的草稿文档。同时，我们还可以尝试新建一个文档：\nhugo new posts/quickstart.md 刷新并点击进入该文档对应的网页视图。\n除此之外，你还可以跟随主题配置指引，根据个人喜好调整主题基础设置，添加或取消部分功能。如果你没有其它定制主题的需求，可直接跳过下一节内容。\n定制基础主题 定制主题除了修改配置文件，还可以重写模板和风格。接下来介绍的个性化配置可能持续更新，且细节部分不做赘述。如果你对我的网站主题配置感兴趣，可以随时查看其对应的仓库源文件。\n ❓ 如何查看我在基础主题上做过哪些调整？\ngit clone https://github.com/jaredyam/jaredyam.github.io.git cat ./config.yml diff -ur themes/PaperMod/assets assets diff -ur themes/PaperMod/layouts layouts  转移目录至侧边栏 Pull Request #675 · adityatelange/hugo-PaperMod 提出将文章目录转移至侧边栏，可以轻松实现上下文跳转。截至发文这一特性还未并入主分支，我们可以让主题子模块追踪该远程 PR 分支：\ncd themes/PaperMod git fetch origin pull/675/head:toc-on-the-side --depth=1 git checkout toc-on-the-side cd ../.. 除了切换到 PR 分支，我们还需要让子模块配置文件 ./gitmodules 指向 PR 分支：\n[submodule \"themes/PaperMod\"] path = \"themes/PaperMod\" url = \"https://github.com/nielsbrakel/hugo-PaperMod.git\" branch = \"toc-on-the-side\" 然后再同步子模块 URL 到 .git/config：\ngit submodule sync 基础主题默认不显示目录栏，我们需要在主题配置文件 ./config.yml 中启用并展开目录：\nbaseURL:https://jaredyam.github.iolanguageCode:en-usdefaultContentLanguage:zhtitle:👨‍🌾 Jared Yam# 主题theme:PaperModparams:# 目录ShowToc:trueTocOpen:true值得注意的是，远程 PR 分支可能并不涵盖主分支的最新特性。你可以通过创建一个 fork 仓库同时追踪主分支和 PR 分支的更新。\n添加评论区 utterances 是一个基于 GitHub issues 的评论系统，包含多种主题可供选择。你应该首先跟随 utterances 配置方法了解可选配置项，并根据个人偏好自动生成一份包含个性化配置属性的 HTML 代码：\nscript src=\"https://utteranc.es/client.js\" repo=\"jaredyam/jaredyam.github.io\" issue-term=\"title\" label=\"Comment\" theme=\"github-light\" crossorigin=\"anonymous\" async script 官方提供的自动生成代码仅支持设置一个固定主题，而我们希望网站主题和评论区主题亮暗模式可以保持同步。参照 Issue #427 · utterance/utterances 的讨论，上述代码可以修改为：\ndiv class=\"comments\" script function loadComment() { let theme = localStorage.getItem('pref-theme') === 'dark' ? 'github-dark' : 'github-light'; let s = document.createElement('script'); s.src = 'https://utteranc.es/client.js'; s.setAttribute('repo', '{{- .Site.Params.commentsParams.repo -}}'); s.setAttribute('issue-term', '{{- .Site.Params.commentsParams.issueTerm -}}'); s.setAttribute('label', '{{- .Site.Params.commentsParams.label -}}'); s.setAttribute('theme', theme); s.setAttribute('crossorigin', 'anonymous'); s.setAttribute('async', ''); document.querySelector('div.comments').innerHTML = ''; document.querySelector('div.comments').appendChild(s); } loadComment(); script div 将修改后的代码写入 ./layouts/partials/comments.html 即可。\n不难看出，我们还需要在主题配置文件 ./config.yml 中添加评论区参数：\nbaseURL:https://jaredyam.github.iolanguageCode:en-usdefaultContentLanguage:zhtitle:👨‍🌾 Jared Yam# 主题theme:PaperModparams:# 目录ShowToc:trueTocOpen:true# 评论区comments:truecommentsParams:repo:jaredyam/jaredyam.github.ioissueTerm:titlelabel:Comment其中 repo，issueTerm，label 的属性值应当与 utterances 自动生成代码保持一致。\n除了在加载网站时使其主题和评论区亮暗模式保持一致外，手动切换网站主题亮暗模式的同时也应该改变评论区主题。在 ./layouts/partials/footer.html:72 区域加入如下代码块：\n{{- if (not .Site.Params.disableThemeToggle) }}  document.getElementById(\"theme-toggle\").addEventListener(\"click\", () = { if (document.body.className.includes(\"dark\")) { document.body.classList.remove('dark'); localStorage.setItem(\"pref-theme\", 'light'); + const message = { + type: 'set-theme', + theme: 'github-light' + }; + const iframe = document.querySelector('.utterances-frame'); + iframe.contentWindow.postMessage(message, 'https://utteranc.es');  } else { document.body.classList.add('dark'); localStorage.setItem(\"pref-theme\", 'dark'); + const message = { + type: 'set-theme', + theme: 'github-dark' + }; + const iframe = document.querySelector('.utterances-frame'); + iframe.contentWindow.postMessage(message, 'https://utteranc.es');  } })  {{- end }} 即可实现这一目的。\n部署网站服务 Hugo 提供非常详尽的 GitHub Pages 部署指引。这里对部署过程做简单梳理：\n 在 ./.github/workflows/ 中放入 gh-pages.yml； 将本地网站同步到 GitHub 同名仓库； 在仓库设置 Settings - Pages 中选择 gh-pages 作为网站资源分支。  完成以上步骤，你便可以通过 https://.github.io 访问自己的个人博客。\n","wordCount":"368","inLanguage":"zh","datePublished":"2022-03-06T20:29:59+08:00","dateModified":"2022-05-08T14:40:45+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://jaredyam.github.io/posts/build-and-deploy-a-static-blog-website-with-hugo-and-github-pages/"},"publisher":{"@type":"Organization","name":"👨‍🌾 Jared Yam","logo":{"@type":"ImageObject","url":"https://jaredyam.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://jaredyam.github.io accesskey=h title="👨‍🌾 Jared Yam (Alt + H)">👨‍🌾 Jared Yam</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://jaredyam.github.io/archives/ title="📚 Archive"><span>📚 Archive</span></a></li><li><a href=https://jaredyam.github.io/tags/ title="🏷 Tags"><span>🏷 Tags</span></a></li><li><a href=https://jaredyam.github.io/search/ title="🔍 Search (Alt + /)" accesskey=/><span>🔍 Search</span></a></li></ul></nav></header><main class="main page"><article class=post-single><header class=post-header><h1 class=post-title>使用 Hugo 和 GitHub Pages 搭建并部署一个静态博客网站</h1><div class=post-description>🔎 https://&lt;your-github-id>.github.io ↩️</div><div class=post-meta><span title="2022-03-06 20:29:59 +0800 +0800">创建于 2022 年三月 6 日</span>&nbsp;·&nbsp;<span title="2022-05-08 14:40:45 +0800 +0800">修改于 2022 年五月 8 日</span></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>目录</span></summary><div class=inner><ul><li><a href=#%e6%90%ad%e5%bb%ba%e9%9d%99%e6%80%81%e7%bd%91%e7%ab%99 aria-label=搭建静态网站>搭建静态网站</a><ul><li><a href=#%e5%ae%89%e8%a3%85-hugo-%e6%a1%86%e6%9e%b6 aria-label="安装 Hugo 框架">安装 Hugo 框架</a></li><li><a href=#%e5%88%9b%e5%bb%ba%e7%bd%91%e7%ab%99%e6%a8%a1%e6%9d%bf aria-label=创建网站模板>创建网站模板</a></li><li><a href=#%e9%85%8d%e7%bd%ae%e5%9f%ba%e7%a1%80%e4%b8%bb%e9%a2%98 aria-label=配置基础主题>配置基础主题</a></li></ul></li><li><a href=#%e5%ae%9a%e5%88%b6%e5%9f%ba%e7%a1%80%e4%b8%bb%e9%a2%98 aria-label=定制基础主题>定制基础主题</a><ul><li><a href=#%e8%bd%ac%e7%a7%bb%e7%9b%ae%e5%bd%95%e8%87%b3%e4%be%a7%e8%be%b9%e6%a0%8f aria-label=转移目录至侧边栏>转移目录至侧边栏</a></li><li><a href=#%e6%b7%bb%e5%8a%a0%e8%af%84%e8%ae%ba%e5%8c%ba aria-label=添加评论区>添加评论区</a></li></ul></li><li><a href=#%e9%83%a8%e7%bd%b2%e7%bd%91%e7%ab%99%e6%9c%8d%e5%8a%a1 aria-label=部署网站服务>部署网站服务</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const e=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${e}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><p>最近打算将我在 <a href=https://blog.csdn.net/weixin_43958105>CSDN</a> 上发布并持续优化的部分内容同步至 GitHub，这些内容十分需要借助 Git 记录和追溯修改历史，而 GitHub 也可以作为这些内容的另一个获取平台。</p><p>将文档直接丢进 GitHub 仓库好像又差点意思。<a href=https://pages.github.com/>GitHub Pages</a> 为每个 GitHub 账户免费提供一项静态网站托管服务，通过域名 <em>https://&lt;your-github-id>.github.io</em> 即可访问同名仓库托管的静态网站。借助这项服务，我们可以依托 GitHub 仓库搭建一个静态博客网站，将文档以博客形式开放展阅。</p><p>本文将介绍<strong>如何使用 <a href=https://gohugo.io/>Hugo</a> 搭建静态博客网站、使用和定制 <a href=https://github.com/adityatelange/hugo-PaperMod>hugo-PaperMod</a> 主题以及将网站部署在 <a href=https://pages.github.com/>GitHub Pages</a></strong>。</p><hr><h2 id=搭建静态网站>搭建静态网站<a hidden class=anchor aria-hidden=true href=#搭建静态网站>#</a></h2><p>如今搭建静态网站的方法已经非常成熟，我根据<a href=https://v2ex.com/t/785625>网友讨论</a>和个人喜好选择 <a href=https://gohugo.io/>Hugo</a> 作为静态网站搭建框架，同样流行的框架还包括 <a href=https://hexo.io/zh-cn/>Hexo</a>、<a href=https://jekyllrb.com/>Jekyll</a> 等。</p><h3 id=安装-hugo-框架>安装 Hugo 框架<a hidden class=anchor aria-hidden=true href=#安装-hugo-框架>#</a></h3><p>Hugo 提供多种操作系统的<a href=https://gohugo.io/getting-started/installing>安装指引</a>。以我的 macOS 系统为例，可以通过包管理器 <code>brew</code> 快速完成安装：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>brew install hugo
</span></span></code></pre></div><h3 id=创建网站模板>创建网站模板<a hidden class=anchor aria-hidden=true href=#创建网站模板>#</a></h3><p>使用 Hugo 可以快速创建一个网站模板：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>brew new site &lt;your-github-id&gt;.github.io -f yml
</span></span></code></pre></div><p>其中 <code>&lt;your-github-id>.github.io</code> 对应新建网站的项目文件夹（<code>&lt;your-github-id></code> 需替换为 GitHub ID），选项 <code>-f</code> 将网站配置文件设置为 <code>YAML</code> 格式，其目的是为与下文主题配置保持一致。为方便起见，下文将网站项目文件夹简称为「网站」。</p><h3 id=配置基础主题>配置基础主题<a hidden class=anchor aria-hidden=true href=#配置基础主题>#</a></h3><p>在流行框架的基础上搭建网站其实并不是一个技术活，千差万别的网站体验则主要体现在网站主题的设计上。Hugo 提供丰富多样的<a href=https://themes.gohugo.io/>主题模板</a>，我根据<a href=https://v2ex.com/t/828677>网友讨论</a>选择 <a href=https://github.com/adityatelange/hugo-PaperMod>adityatelange/hugo-PaperMod</a> 作为基础主题。<a href=https://github.com/adityatelange/hugo-PaperMod>PaperMod</a> 页面简洁，支持暗黑模式及众多<a href=https://github.com/adityatelange/hugo-PaperMod/wiki/Features#default-theme-lightdarkauto>实用特性</a>。</p><p>在网站根目录执行以下命令下载主题并初始化为 Git 子模块：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git clone https://github.com/adityatelange/hugo-PaperMod themes/PaperMod --depth<span class=o>=</span><span class=m>1</span>
</span></span><span class=line><span class=cl>git init
</span></span><span class=line><span class=cl>git submodule--helper add https://github.com/adityatelange/hugo-PaperMod.git themes/PaperMod --depth<span class=o>=</span><span class=m>1</span>
</span></span></code></pre></div><p>随后，我们只需将主题名称写入配置文件 <code>./config.yml</code>：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>baseURL</span><span class=p>:</span><span class=w> </span><span class=l>https://jaredyam.github.io</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>languageCode</span><span class=p>:</span><span class=w> </span><span class=l>en-us</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>defaultContentLanguage</span><span class=p>:</span><span class=w> </span><span class=l>zh</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>title</span><span class=p>:</span><span class=w> </span><span class=l>👨‍🌾 Jared Yam</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># 主题</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>theme</span><span class=p>:</span><span class=w> </span><span class=l>PaperMod</span><span class=w>
</span></span></span></code></pre></div><p>便搭建完成了一个完整的静态博客网站。</p><p>执行以下命令可以在本地预览网站：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>hugo server -D
</span></span></code></pre></div><p>其中选项 <code>-D</code> 允许在预览网站时渲染未发布的草稿文档。同时，我们还可以尝试新建一个文档：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>hugo new posts/quickstart.md
</span></span></code></pre></div><p>刷新并点击进入该文档对应的网页视图。</p><p>除此之外，你还可以跟随<a href=https://github.com/adityatelange/hugo-PaperMod/wiki/Features#default-theme-lightdarkauto>主题配置指引</a>，根据个人喜好调整主题基础设置，添加或取消部分功能。如果你没有其它定制主题的需求，可直接跳过下一节内容。</p><h2 id=定制基础主题>定制基础主题<a hidden class=anchor aria-hidden=true href=#定制基础主题>#</a></h2><p>定制主题除了修改配置文件，还可以<a href=https://github.com/adityatelange/hugo-PaperMod/wiki/FAQs#override-theme-template>重写模板和风格</a>。接下来介绍的个性化配置可能持续更新，且细节部分不做赘述。如果你对我的网站主题配置感兴趣，可以随时查看其对应的<a href=https://github.com/jaredyam/jaredyam.github.io>仓库源文件</a>。</p><blockquote><p><strong>❓ 如何查看我在基础主题上做过哪些调整？</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git clone https://github.com/jaredyam/jaredyam.github.io.git
</span></span><span class=line><span class=cl>cat ./config.yml
</span></span><span class=line><span class=cl>diff -ur themes/PaperMod/assets assets
</span></span><span class=line><span class=cl>diff -ur themes/PaperMod/layouts layouts
</span></span></code></pre></div></blockquote><h3 id=转移目录至侧边栏>转移目录至侧边栏<a hidden class=anchor aria-hidden=true href=#转移目录至侧边栏>#</a></h3><p><a href=https://github.com/adityatelange/hugo-PaperMod/pull/675>Pull Request #675 · adityatelange/hugo-PaperMod</a> 提出将文章目录转移至侧边栏，可以轻松实现上下文跳转。截至发文这一特性还未并入主分支，我们可以让主题子模块追踪该远程 PR 分支：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> themes/PaperMod
</span></span><span class=line><span class=cl>git fetch origin pull/675/head:toc-on-the-side --depth<span class=o>=</span><span class=m>1</span>
</span></span><span class=line><span class=cl>git checkout toc-on-the-side
</span></span><span class=line><span class=cl><span class=nb>cd</span> ../..
</span></span></code></pre></div><p>除了切换到 PR 分支，我们还需要让子模块配置文件 <code>./gitmodules</code> 指向 PR 分支：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=k>[submodule &#34;themes/PaperMod&#34;]</span>
</span></span><span class=line><span class=cl>    <span class=na>path</span> <span class=o>=</span> <span class=s>&#34;themes/PaperMod&#34;
</span></span></span><span class=line><span class=cl><span class=s>    url = &#34;https://github.com/nielsbrakel/hugo-PaperMod.git&#34;
</span></span></span><span class=line><span class=cl><span class=s>    branch = &#34;toc-on-the-side&#34;</span>
</span></span></code></pre></div><p>然后再同步子模块 URL 到 <code>.git/config</code>：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git submodule sync
</span></span></code></pre></div><p>基础主题默认不显示目录栏，我们需要在主题配置文件 <code>./config.yml</code> 中启用并展开目录：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>baseURL</span><span class=p>:</span><span class=w> </span><span class=l>https://jaredyam.github.io</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>languageCode</span><span class=p>:</span><span class=w> </span><span class=l>en-us</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>defaultContentLanguage</span><span class=p>:</span><span class=w> </span><span class=l>zh</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>title</span><span class=p>:</span><span class=w> </span><span class=l>👨‍🌾 Jared Yam</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># 主题</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>theme</span><span class=p>:</span><span class=w> </span><span class=l>PaperMod</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>params</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># 目录</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ShowToc</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>TocOpen</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span></code></pre></div><p>值得注意的是，远程 PR 分支可能并不涵盖主分支的最新特性。你可以通过创建一个 fork 仓库同时追踪主分支和 PR 分支的更新。</p><h3 id=添加评论区>添加评论区<a hidden class=anchor aria-hidden=true href=#添加评论区>#</a></h3><p><a href=https://utteranc.es/>utterances</a> 是一个基于 GitHub issues 的评论系统，包含多种主题可供选择。你应该首先跟随 <a href=https://utteranc.es/>utterances 配置方法</a>了解可选配置项，并根据个人偏好自动生成一份包含个性化配置属性的 <code>HTML</code> 代码：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;https://utteranc.es/client.js&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>repo</span><span class=o>=</span><span class=s>&#34;jaredyam/jaredyam.github.io&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>issue-term</span><span class=o>=</span><span class=s>&#34;title&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>label</span><span class=o>=</span><span class=s>&#34;Comment&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>theme</span><span class=o>=</span><span class=s>&#34;github-light&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>crossorigin</span><span class=o>=</span><span class=s>&#34;anonymous&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>async</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>官方提供的自动生成代码仅支持设置一个固定主题，而我们希望网站主题和评论区主题亮暗模式可以保持同步。参照 <a href=https://github.com/utterance/utterances/issues/427>Issue #427 · utterance/utterances</a> 的讨论，上述代码可以修改为：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;comments&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nx>loadComment</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>let</span> <span class=nx>theme</span> <span class=o>=</span> <span class=nx>localStorage</span><span class=p>.</span><span class=nx>getItem</span><span class=p>(</span><span class=s1>&#39;pref-theme&#39;</span><span class=p>)</span> <span class=o>===</span> <span class=s1>&#39;dark&#39;</span> <span class=o>?</span> <span class=s1>&#39;github-dark&#39;</span> <span class=o>:</span> <span class=s1>&#39;github-light&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kd>let</span> <span class=nx>s</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>createElement</span><span class=p>(</span><span class=s1>&#39;script&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>s</span><span class=p>.</span><span class=nx>src</span> <span class=o>=</span> <span class=s1>&#39;https://utteranc.es/client.js&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nx>s</span><span class=p>.</span><span class=nx>setAttribute</span><span class=p>(</span><span class=s1>&#39;repo&#39;</span><span class=p>,</span> <span class=s1>&#39;{{- .Site.Params.commentsParams.repo -}}&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>s</span><span class=p>.</span><span class=nx>setAttribute</span><span class=p>(</span><span class=s1>&#39;issue-term&#39;</span><span class=p>,</span> <span class=s1>&#39;{{- .Site.Params.commentsParams.issueTerm -}}&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>s</span><span class=p>.</span><span class=nx>setAttribute</span><span class=p>(</span><span class=s1>&#39;label&#39;</span><span class=p>,</span> <span class=s1>&#39;{{- .Site.Params.commentsParams.label -}}&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>s</span><span class=p>.</span><span class=nx>setAttribute</span><span class=p>(</span><span class=s1>&#39;theme&#39;</span><span class=p>,</span> <span class=nx>theme</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>s</span><span class=p>.</span><span class=nx>setAttribute</span><span class=p>(</span><span class=s1>&#39;crossorigin&#39;</span><span class=p>,</span> <span class=s1>&#39;anonymous&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>s</span><span class=p>.</span><span class=nx>setAttribute</span><span class=p>(</span><span class=s1>&#39;async&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nb>document</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s1>&#39;div.comments&#39;</span><span class=p>).</span><span class=nx>innerHTML</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nb>document</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s1>&#39;div.comments&#39;</span><span class=p>).</span><span class=nx>appendChild</span><span class=p>(</span><span class=nx>s</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>loadComment</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>将修改后的代码写入 <code>./layouts/partials/comments.html</code> 即可。</p><p>不难看出，我们还需要在主题配置文件 <code>./config.yml</code> 中添加评论区参数：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>baseURL</span><span class=p>:</span><span class=w> </span><span class=l>https://jaredyam.github.io</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>languageCode</span><span class=p>:</span><span class=w> </span><span class=l>en-us</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>defaultContentLanguage</span><span class=p>:</span><span class=w> </span><span class=l>zh</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>title</span><span class=p>:</span><span class=w> </span><span class=l>👨‍🌾 Jared Yam</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># 主题</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>theme</span><span class=p>:</span><span class=w> </span><span class=l>PaperMod</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>params</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># 目录</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ShowToc</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>TocOpen</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># 评论区</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>comments</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>commentsParams</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>repo</span><span class=p>:</span><span class=w> </span><span class=l>jaredyam/jaredyam.github.io</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>issueTerm</span><span class=p>:</span><span class=w> </span><span class=l>title</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>label</span><span class=p>:</span><span class=w> </span><span class=l>Comment</span><span class=w>
</span></span></span></code></pre></div><p>其中 <code>repo</code>，<code>issueTerm</code>，<code>label</code> 的属性值应当与 utterances 自动生成代码保持一致。</p><p>除了在加载网站时使其主题和评论区亮暗模式保持一致外，手动切换网站主题亮暗模式的同时也应该改变评论区主题。在 <code>./layouts/partials/footer.html:72</code> 区域加入如下代码块：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-diff data-lang=diff><span class=line><span class=cl>{{- if (not .Site.Params.disableThemeToggle) }}
</span></span><span class=line><span class=cl>&lt;script&gt;
</span></span><span class=line><span class=cl>    document.getElementById(&#34;theme-toggle&#34;).addEventListener(&#34;click&#34;, () =&gt; {
</span></span><span class=line><span class=cl>        if (document.body.className.includes(&#34;dark&#34;)) {
</span></span><span class=line><span class=cl>            document.body.classList.remove(&#39;dark&#39;);
</span></span><span class=line><span class=cl>            localStorage.setItem(&#34;pref-theme&#34;, &#39;light&#39;);
</span></span><span class=line><span class=cl><span class=gi>+           const message = {
</span></span></span><span class=line><span class=cl><span class=gi>+               type: &#39;set-theme&#39;,
</span></span></span><span class=line><span class=cl><span class=gi>+               theme: &#39;github-light&#39;
</span></span></span><span class=line><span class=cl><span class=gi>+           };
</span></span></span><span class=line><span class=cl><span class=gi>+           const iframe = document.querySelector(&#39;.utterances-frame&#39;);
</span></span></span><span class=line><span class=cl><span class=gi>+           iframe.contentWindow.postMessage(message, &#39;https://utteranc.es&#39;);
</span></span></span><span class=line><span class=cl><span class=gi></span>        } else {
</span></span><span class=line><span class=cl>            document.body.classList.add(&#39;dark&#39;);
</span></span><span class=line><span class=cl>            localStorage.setItem(&#34;pref-theme&#34;, &#39;dark&#39;);
</span></span><span class=line><span class=cl><span class=gi>+           const message = {
</span></span></span><span class=line><span class=cl><span class=gi>+               type: &#39;set-theme&#39;,
</span></span></span><span class=line><span class=cl><span class=gi>+               theme: &#39;github-dark&#39;
</span></span></span><span class=line><span class=cl><span class=gi>+           };
</span></span></span><span class=line><span class=cl><span class=gi>+           const iframe = document.querySelector(&#39;.utterances-frame&#39;);
</span></span></span><span class=line><span class=cl><span class=gi>+           iframe.contentWindow.postMessage(message, &#39;https://utteranc.es&#39;);
</span></span></span><span class=line><span class=cl><span class=gi></span>        }
</span></span><span class=line><span class=cl>    })
</span></span><span class=line><span class=cl>&lt;/script&gt;
</span></span><span class=line><span class=cl>{{- end }}
</span></span></code></pre></div><p>即可实现这一目的。</p><h2 id=部署网站服务>部署网站服务<a hidden class=anchor aria-hidden=true href=#部署网站服务>#</a></h2><p>Hugo 提供非常详尽的 <a href=https://gohugo.io/hosting-and-deployment/hosting-on-github/>GitHub Pages 部署指引</a>。这里对部署过程做简单梳理：</p><ol><li>在 <code>./.github/workflows/</code> 中放入 <a href=https://gohugo.io/hosting-and-deployment/hosting-on-github/#build-hugo-with-github-action>gh-pages.yml</a>；</li><li>将本地网站同步到 GitHub 同名仓库；</li><li>在仓库设置 <code>Settings -> Pages</code> 中选择 <code>gh-pages</code> 作为网站资源分支。</li></ol><p>完成以上步骤，你便可以通过 <em>https://&lt;your-github-id>.github.io</em> 访问自己的个人博客。</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://jaredyam.github.io/tags/hugo/>Hugo</a></li><li><a href=https://jaredyam.github.io/tags/github-pages/>GitHub Pages</a></li></ul></footer><div class=comments><script>function loadComment(){let t=localStorage.getItem("pref-theme")==="dark"?"github-dark":"github-light",e=document.createElement("script");e.src="https://utteranc.es/client.js",e.setAttribute("repo","jaredyam/jaredyam.github.io"),e.setAttribute("issue-term","title"),e.setAttribute("label","Comment"),e.setAttribute("theme",t),e.setAttribute("crossorigin","anonymous"),e.setAttribute("async",''),document.querySelector("div.comments").innerHTML='',document.querySelector("div.comments").appendChild(e)}loadComment()</script></div></article></main><footer class=footer><span>&copy; 2022 <a href=https://jaredyam.github.io>👨‍🌾 Jared Yam</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{if(document.body.className.includes("dark")){document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light");const e={type:"set-theme",theme:"github-light"},t=document.querySelector(".utterances-frame");t.contentWindow.postMessage(e,"https://utteranc.es")}else{document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark");const e={type:"set-theme",theme:"github-dark"},t=document.querySelector(".utterances-frame");t.contentWindow.postMessage(e,"https://utteranc.es")}})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerText="复制";function s(){e.innerText="已复制！",setTimeout(()=>{e.innerText="复制"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>